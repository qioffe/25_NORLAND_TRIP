<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Norland Trip Application Guide</title>
    <link rel="icon" type="image/x-icon" href="https://placehold.co/16x16/3B82F6/ffffff?text=N">
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,0,0" />
    <style>
        /**
         * @file Refactored and concise stylesheet for the travel dashboard with a dynamic background.
         * @author Q
         * @version 3.8
         */
        :root {
            --md-sys-color-primary: #3B82F6;
            --md-sys-color-primary-light: #60A5FA;
            --md-sys-color-primary-container: #EFF6FF;
            --md-sys-color-on-primary: #FFFFFF;
            --md-sys-color-secondary-container: #E0E7FF;
            --md-sys-color-on-secondary-container: #3730A3;
            --md-sys-color-surface: #F8FBFE;
            --md-sys-color-outline: #DDE8F4;
            --md-sys-color-pulse: rgba(59, 130, 246, 0.4);
        }

        /* --- Body & Dynamic Background --- */
        body { 
            font-family: 'Inter', sans-serif; 
            color: #1e293b;
            /* Dynamic Fluid Background */
            background: linear-gradient(-45deg, #a7b7ff, #eff6ff, #dbeafe, #c1d4ff);
            background-size: 400% 400%;
            animation: fluid-gradient 20s ease infinite;
        }

        /* --- Animations --- */
        @keyframes fluid-gradient {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }
        @keyframes pulse-glow {
            0%, 100% { box-shadow: 0 0 0 0 transparent; }
            70% { box-shadow: 0 0 0 10px var(--md-sys-color-pulse); }
        }
        @keyframes gradient-shift { 50% { background-position: 100% 50%; } }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        
        /* --- Layout & Cards --- */
        .main-container { 
            border-radius: 24px; 
            background-color: rgba(255, 255, 255, 0.55); /* More transparent for a glass effect */
            backdrop-filter: blur(20px); /* Increased blur for glass effect */
            -webkit-backdrop-filter: blur(20px); /* Safari support */
            box-shadow: 0 10px 30px -5px rgba(0,0,0,0.07), 0 4px 15px -6px rgba(0,0,0,0.05); 
            transition: opacity 0.5s ease-in-out; 
            opacity: 0; 
            overflow: hidden; 
            border: 1px solid rgba(255, 255, 255, 0.5); /* Lighter border */
        }
        .main-container.is-visible { opacity: 1; }
        .m3-elevated-card { 
            border-radius: 16px; /* Slightly larger radius */
            background-color: rgba(248, 251, 254, 0.65); /* Added transparency */
            backdrop-filter: blur(10px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.05); 
            border: 1px solid var(--md-sys-color-outline); 
        }
        .interactive-card {
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        .interactive-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 10px 20px rgba(0,0,0,0.08);
        }
        .interactive-card:active {
            transform: scale(0.98);
        }

        /* --- Tabs --- */
        .tabs-container { border-bottom: 1px solid var(--md-sys-color-outline); }
        .tab-list { display: flex; justify-content: center; }
        .tab-btn { display: flex; align-items: center; justify-content: center; height: 48px; padding: 0 24px; font-size: 0.9rem; color: #475569; position: relative; flex-grow: 1; border: none; background-color: transparent; font-weight: 600; cursor: pointer; transition: background-color 0.2s; }
        .tab-btn::after { content: ''; position: absolute; bottom: -1px; left: 0; right: 0; height: 3px; background-color: var(--md-sys-color-primary); border-radius: 3px 3px 0 0; transform: scaleX(0); transition: transform 0.3s ease; }
        .tab-btn:hover { background-color: rgba(0,0,0,0.04); }
        .tab-btn.is-active { color: var(--md-sys-color-primary); }
        .tab-btn.is-active::after { transform: scaleX(1); }

        /* --- Document List & Instructions --- */
        .document-list-item, .instruction-card, .instruction-link { display: flex; text-decoration: none; color: inherit; border-radius: 12px; transition: background-color 0.2s, transform 0.2s; }
        .document-list-item { align-items: center; padding: 1rem; }
        .document-list-item:not(:last-child) { border-bottom: 1px solid var(--md-sys-color-outline); }
        .instruction-card, .instruction-link { align-items: flex-start; gap: 0.75rem; padding: 0.75rem; border: 1px solid var(--md-sys-color-outline); background-color: rgba(247, 250, 252, 0.7); }
        .instruction-card:hover, .instruction-link:hover { background-color: var(--md-sys-color-primary-container); transform: scale(1.02); }
        .instruction-card:active, .instruction-link:active { transform: scale(0.99); transition-duration: 0.1s; } /* Press effect */
        .document-list-item:hover { background-color: var(--md-sys-color-primary-container); }
        .document-list-icon, .instruction-icon-container { flex-shrink: 0; }
        .document-list-icon { margin-right: 1rem; color: var(--md-sys-color-primary); }
        .instruction-icon-container { 
            width: 3rem; /* Increased size */
            height: 3rem; /* Increased size */
            border-radius: 9999px; 
            background-color: var(--md-sys-color-primary-container); 
            color: var(--md-sys-color-primary); 
            display: flex; 
            align-items: center; 
            justify-content: center; 
        }
        .document-list-text, .instruction-content { flex-grow: 1; }
        .document-list-action { flex-shrink: 0; margin-left: 1rem; color: var(--md-sys-color-primary); font-weight: 600; display: inline-flex; align-items: center; gap: 0.25rem; }

        /* --- Stepper --- */
        .stepper-container { display: flex; justify-content: space-between; margin: 0 auto 2.5rem; max-width: 56rem; }
        .stepper-item { display: flex; flex-direction: column; align-items: center; flex-grow: 1; position: relative; cursor: pointer; }
        .stepper-item:not(:last-child)::after { content: ''; position: absolute; top: 1.25rem; left: 50%; width: 100%; height: 2px; background-color: var(--md-sys-color-outline); z-index: 1; transition: background-color 0.3s; }
        .stepper-icon { 
            width: 3rem; /* Increased size to 48px */
            height: 3rem; /* Increased size to 48px */
            border-radius: 9999px; 
            display: flex; 
            align-items: center; 
            justify-content: center; 
            background-color: #DDE8F4; 
            color: #4B5563; 
            font-weight: 600; 
            z-index: 2; 
            transition: all 0.3s; 
            border: 4px solid var(--md-sys-color-surface); 
            position: relative; 
        }
        .stepper-icon .step-number, .stepper-icon .step-checkmark { transition: opacity 0.3s ease-in-out; position: absolute; }
        .stepper-icon .step-checkmark { opacity: 0; }
        .stepper-label { margin-top: 0.5rem; font: 500 0.875rem/1.25rem sans-serif; color: #64748B; text-align: center; transition: color 0.3s, font-weight 0.3s; }
        .stepper-item.is-active .stepper-icon, .stepper-item.is-completed .stepper-icon { background-color: var(--md-sys-color-primary); color: var(--md-sys-color-on-primary); }
        .stepper-item.is-active .stepper-icon { animation: pulse-glow 2s infinite; }
        .stepper-item.is-active .stepper-label { color: var(--md-sys-color-primary); font-weight: 700; }
        .stepper-item.is-completed .step-number { opacity: 0; }
        .stepper-item.is-completed .step-checkmark { opacity: 1; }
        .stepper-item.is-completed:not(:last-child)::after { background-color: var(--md-sys-color-primary); }
        .step-content { display: none; animation: fadeIn 0.5s ease-in-out; }
        .step-content.is-active { display: block; }

        /* --- Stepper Navigation --- */
        .stepper-nav { display: flex; justify-content: space-between; margin-top: 2rem; padding-top: 1.5rem; border-top: 1px solid var(--md-sys-color-outline); }
        .stepper-btn { padding: 0.75rem 1.5rem; border-radius: 9999px; font-weight: 600; cursor: pointer; transition: all 0.2s; border: none; }
        .stepper-btn.primary { background: linear-gradient(to right, var(--md-sys-color-primary), var(--md-sys-color-primary-light), var(--md-sys-color-primary)); background-size: 200% 100%; color: var(--md-sys-color-on-primary); animation: gradient-shift 4s ease infinite; }
        .stepper-btn.secondary { background-color: #E6EEF5; color: #475569; }
        .stepper-btn:disabled { background-color: #E6EEF5; background-image: none; color: #94A3B8; cursor: not-allowed; }

        /* --- Misc & Utilities --- */
        .action-tag { background-color: var(--md-sys-color-secondary-container); color: var(--md-sys-color-on-secondary-container); padding: 0.25rem 0.75rem; border-radius: 9999px; font-size: 0.875rem; font-weight: 600; display: inline-block; margin: 0.25rem 0; }
        .m3-divider { height: 1px; background-color: var(--md-sys-color-outline); border: none; }
        .text-gradient-primary { background: linear-gradient(to right, var(--md-sys-color-primary), var(--md-sys-color-primary-light)); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
        
        /* --- Flight Card --- */
        .flight-card-v2 {
            border-radius: 16px;
            background: linear-gradient(135deg, rgba(255,255,255,0.7) 0%, rgba(248,251,254,0.7) 100%);
            backdrop-filter: blur(10px);
            box-shadow: 0 8px 16px rgba(17, 24, 39, 0.05);
            border: 1px solid var(--md-sys-color-outline);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            overflow: hidden;
            position: relative;
            padding: 1.5rem;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
        }

        .flight-card-v2:hover {
            transform: translateY(-6px);
            box-shadow: 0 12px 24px rgba(17, 24, 39, 0.08);
        }
        
        .flight-price-container {
            text-align: right;
        }
        
        .flight-price-value {
            font-size: 2.5rem; /* 40px */
            font-weight: 800;
            line-height: 1;
            color: #1e293b;
            display: inline-block;
        }
        
        .flight-price-value .currency {
            font-size: 1.5rem;
            font-weight: 600;
            vertical-align: top;
            margin-right: 2px;
            color: #64748b;
        }
        
        .flight-main-route {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin: 1.5rem 0;
        }
        
        .flight-airport-code {
            font-size: 2.25rem; /* 36px */
            font-weight: 900;
            color: var(--md-sys-color-primary);
        }
        
        .flight-path-animated {
            flex-grow: 1;
            height: 2px;
            background-image: linear-gradient(to right, var(--md-sys-color-primary) 50%, transparent 50%);
            background-size: 10px 2px;
            position: relative;
            margin: 0 1rem;
        }
        
        @keyframes flight-move {
            from { left: 0; }
            to { left: calc(100% - 24px); } /* 24px is icon size */
        }
        
        .flight-details {
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 0.75rem; /* 12px */
            color: #64748b;
            border-top: 1px solid var(--md-sys-color-outline);
            padding-top: 0.75rem;
            margin-top: 1rem;
        }

        .flight-card-v2.placeholder {
            filter: blur(4px);
            opacity: 0.6;
            background: #f8fafc;
        }

        /* --- NEW Date Card Styles --- */
        #date-card {
            border-radius: 1.5rem;
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.75) 0%, rgba(248, 251, 254, 0.75) 100%);
            box-shadow: 0 8px 16px rgba(0,0,0,0.05);
            border: 1px solid rgba(255,255,255,0.4);
            padding: 1rem;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
            cursor: pointer;
            transition: transform 0.2s ease-in-out, box-shadow 0.2s ease-in-out;
            min-height: auto;
        }
        #date-card:hover {
            box-shadow: 0 12px 24px rgba(0,0,0,0.08);
            transform: translateY(-4px);
        }
        #date-card:active {
            transform: scale(0.98);
            transition-duration: 0.05s;
        }

        .date-view, .countdown-view {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }
        .main-number {
            font-size: 3.5rem; /* 56px */
            line-height: 1;
        }
        .label-text {
            font-size: 1.125rem; /* 18px */
        }
    </style>
</head>
<body class="flex flex-col items-center min-h-screen py-8 px-4">
    <div class="main-container w-full max-w-7xl mx-auto p-6 sm:p-8">
        <!-- Dashboard Section -->
        <section id="dashboard-section" class="grid grid-cols-1 md:grid-cols-[2fr,2fr,1fr] gap-8">
            <div id="flight-card-fll" class="flight-card-v2 placeholder interactive-card">
                <div class="flight-price-container">
                    <p class="flight-price-value"><span class="currency">$</span>----</p>
                </div>
                <div class="flight-main-route">
                    <p class="flight-airport-code departure">FLL</p>
                    <div class="flight-path-animated">
                        <span class="material-symbols-outlined flight-icon-animated">flight</span>
                    </div>
                    <p class="flight-airport-code arrival">PVG</p>
                </div>
                <div class="flight-details">
                    <p class="flight-route-info">Fetching route...</p>
                    <p class="flight-last-updated">Updating...</p>
                </div>
            </div>
            <div id="flight-card-mia" class="flight-card-v2 placeholder interactive-card">
                <div class="flight-price-container">
                    <p class="flight-price-value"><span class="currency">$</span>----</p>
                </div>
                <div class="flight-main-route">
                    <p class="flight-airport-code departure">MIA</p>
                    <div class="flight-path-animated">
                        <span class="material-symbols-outlined flight-icon-animated">flight</span>
                    </div>
                    <p class="flight-airport-code arrival">PVG</p>
                </div>
                <div class="flight-details">
                    <p class="flight-route-info">Fetching route...</p>
                    <p class="flight-last-updated">Updating...</p>
                </div>
            </div>
            <!-- Date & Countdown Card -->
            <div id="date-card" class="interactive-card rounded-2xl cursor-pointer flex flex-col justify-center items-center text-center overflow-hidden p-4 relative bg-white/50" role="button" aria-label="Toggle date and countdown view">
                <p class="text-sm font-semibold text-gray-500 mb-2 uppercase tracking-wider relative z-10">DEPARTURE</p>
                <div id="date-view" class="date-view">
                    <p class="main-number font-extrabold text-gradient-primary">22</p>
                    <p class="label-text font-bold text-gray-600 tracking-wider">NOV</p>
                </div>
                <div id="countdown-view" class="countdown-view hidden">
                    <p id="countdown-days" class="main-number font-extrabold text-gradient-primary">0</p>
                    <p class="label-text font-bold text-gray-600 tracking-wider">DAYS LEFT</p>
                </div>
            </div>
        </section>
        
        <hr class="m3-divider my-12">
        
        <header class="flex justify-between items-center pb-8">
            <div>
                <h1 class="text-2xl sm:text-3xl font-bold text-gray-800">Application Guideline</h1>
            </div>
            <button class="w-12 h-12 rounded-full flex items-center justify-center text-gray-500 hover:bg-gray-100 active:bg-gray-200 transition flex-shrink-0" aria-label="Share">
                <span class="material-symbols-outlined">share</span>
            </button>
        </header>

        <!-- Navigation Tabs -->
        <nav class="tabs-container max-w-3xl mx-auto">
            <div class="tab-list" role="tablist">
                <button class="tab-btn is-active" data-tab="process-tab" role="tab" aria-selected="true" tabindex="0">Application Process</button>
                <button class="tab-btn" data-tab="documents-tab" role="tab" aria-selected="false" tabindex="0">Downloadable Forms</button>
            </div>
        </nav>
        
        <!-- Tab Content -->
        <div class="mt-12">
            <!-- Process Stepper Tab -->
            <div id="process-tab" class="tab-content" style="display:block;">
                <div id="stepper-ui-container">
                    <div class="stepper stepper-container">
                        <div class="stepper-item is-active" data-step="1" tabindex="0">
                            <div class="stepper-icon"><span class="step-number">1</span><span class="material-symbols-outlined step-checkmark">check</span></div>
                            <div class="stepper-label">Invitation</div>
                        </div>
                        <div class="stepper-item" data-step="2" tabindex="0">
                            <div class="stepper-icon"><span class="step-number">2</span><span class="material-symbols-outlined step-checkmark">check</span></div>
                            <div class="stepper-label">Documents</div>
                        </div>
                        <div class="stepper-item" data-step="3" tabindex="0">
                            <div class="stepper-icon"><span class="step-number">3</span><span class="material-symbols-outlined step-checkmark">check</span></div>
                            <div class="stepper-label">Application</div>
                        </div>
                        <div class="stepper-item" data-step="4" tabindex="0">
                            <div class="stepper-icon"><span class="step-number">4</span><span class="material-symbols-outlined step-checkmark">check</span></div>
                            <div class="stepper-label">Submission</div>
                        </div>
                    </div>

                    <div class="step-content-container">
                        <!-- Step Content will be dynamically shown here -->
                    </div>
                    
                    <div class="stepper-nav">
                        <button id="prev-step-btn" class="stepper-btn secondary">Previous</button>
                        <button id="next-step-btn" class="stepper-btn primary">Next Step</button>
                    </div>
                </div>
            </div>

            <!-- Documents Tab -->
            <div id="documents-tab" class="tab-content" style="display:none;">
                <div class="m3-elevated-card p-4 space-y-2">
                    <a href="https://qioffe.github.io/25_NORLAND_TRIP/Consent_Letter.pdf" target="_blank" rel="noopener noreferrer" class="document-list-item"><div class="document-list-icon"><span class="material-symbols-outlined text-4xl">description</span></div><div class="document-list-text"><h3 class="font-semibold text-gray-800">Consent Letter</h3><p class="text-sm text-gray-600">A notarized form for minors.</p></div><div class="document-list-action"><span>Download</span></div></a>
                    <a href="https://qioffe.github.io.io/25_NORLAND_TRIP/JESIE_application.pdf" target="_blank" rel="noopener noreferrer" class="document-list-item"><div class="document-list-icon"><span class="material-symbols-outlined text-4xl">description</span></div><div class="document-list-text"><h3 class="font-semibold text-gray-800">JESIE Application</h3><p class="text-sm text-gray-600">The main program application form.</p></div><div class="document-list-action"><span>Download</span></div></a>
                    <a href="https://qioffe.github.io/25_NORLAND_TRIP/cova_2013.pdf" target="_blank" rel="noopener noreferrer" class="document-list-item"><div class="document-list-icon"><span class="material-symbols-outlined text-4xl">description</span></div><div class="document-list-text"><h3 class="font-semibold text-gray-800">Visa Application Templates (COVA)</h3><p class="text-sm text-gray-600">A guide for the official COVA form.</p></div><div class="document-list-action"><span>Download</span></div></a>
                    <a href="https://qioffe.github.io/25_NORLAND_TRIP/WYS.pdf" target="_blank" rel="noopener noreferrer" class="document-list-item"><div class="document-list-icon"><span class="material-symbols-outlined text-4xl">description</span></div><div class="document-list-text"><h3 class="font-semibold text-gray-800">Where You Stay Form (WYS)</h3><p class="text-sm text-gray-600">A supplementary visa office form.</p></div><div class="document-list-action"><span>Download</span></div></a>
                </div>
            </div>
        </div>
    </div>

    <script>
        /**
         * @file Modern, event-driven UI script for a travel dashboard.
         * @author Q
         * @version 3.1
         */
        document.addEventListener('DOMContentLoaded', () => {
            const mainContainer = document.querySelector('.main-container');
            mainContainer.classList.add('is-visible');

            const stepContents = {
                1: `
                    <div class="m3-elevated-card p-6">
                        <h2 class="text-2xl font-bold text-gray-800 mb-3">Obtain Official Invitation Letter</h2>
                        <p class="text-gray-600 mb-8">Your first action is to complete the form provided by your program to receive the mandatory invitation letter.</p>
                        <a href="https://qioffe.github.io/25_NORLAND_TRIP/JESIE_application.pdf" target="_blank" rel="noopener noreferrer" class="instruction-link">
                            <div class="instruction-icon-container"><span class="material-symbols-outlined text-xl">description</span></div>
                            <div class="instruction-content">
                                <h4 class="font-semibold text-gray-800 text-sm">Complete the JESIS Form</h4>
                                <p class="text-xs text-gray-600 mt-1">Once submitted, we will issue the Official Invitation Letter.</p>
                            </div>
                            <span class="material-symbols-outlined text-base text-gray-400">open_in_new</span>
                        </a>
                    </div>`,
                2: `
                    <div class="m3-elevated-card p-6">
                        <h2 class="text-2xl font-bold text-gray-800 mb-3">Gather Required Documents</h2>
                        <p class="text-gray-600 mb-8">With the invitation letter, <span class="action-tag">collect the following items</span>. This is the most important step.</p>
                        <div class="space-y-6">
                            <div>
                                <h3 class="text-lg font-semibold text-gray-700 mb-4">Personal & Guardian Documents</h3>
                                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                    <div class="instruction-card"><div class="instruction-icon-container"><span class="material-symbols-outlined text-xl">contact_page</span></div><div class="instruction-content"><h4 class="font-semibold text-gray-800 text-sm">Original Passport</h4><p class="text-xs text-gray-600 mt-1">Must have 6+ months validity & 2 blank pages.</p></div></div>
                                    <div class="instruction-card"><div class="instruction-icon-container"><span class="material-symbols-outlined text-xl">badge</span></div><div class="instruction-content"><h4 class="font-semibold text-gray-800 text-sm">Passport Bio-Data Page</h4><p class="text-xs text-gray-600 mt-1">A clear photocopy.</p></div></div>
                                    <div class="instruction-card"><div class="instruction-icon-container"><span class="material-symbols-outlined text-xl">account_box</span></div><div class="instruction-content"><h4 class="font-semibold text-gray-800 text-sm">Guardian's Photo ID</h4><p class="text-xs text-gray-600 mt-1">A clear photocopy of a valid ID.</p></div></div>
                                    <div class="instruction-card"><div class="instruction-icon-container"><span class="material-symbols-outlined text-xl">home</span></div><div class="instruction-content"><h4 class="font-semibold text-gray-800 text-sm">Proof of Address</h4><p class="text-xs text-gray-600 mt-1">Utility bill or bank statement.</p></div></div>
                                    <div class="instruction-card"><div class="instruction-icon-container"><span class="material-symbols-outlined text-xl">family_restroom</span></div><div class="instruction-content"><h4 class="font-semibold text-gray-800 text-sm">Proof of Relationship</h4><p class="text-xs text-gray-600 mt-1">Birth certificate or court order.</p></div></div>
                                </div>
                            </div>
                            <div>
                                <h3 class="text-lg font-semibold text-gray-700 mb-4">Program & Visa Forms</h3>
                                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                    <a href="https://qioffe.github.io/25_NORLAND_TRIP/Consent_Letter.pdf" target="_blank" rel="noopener noreferrer" class="instruction-link"><div class="instruction-icon-container"><span class="material-symbols-outlined text-xl">gavel</span></div><div class="instruction-content"><h4 class="font-semibold text-gray-800 text-sm">Notarized Consent Form</h4><p class="text-xs text-gray-600 mt-1">Must be signed and notarized.</p></div><span class="material-symbols-outlined text-base text-gray-400">open_in_new</span></a>
                                    <a href="https://qioffe.github.io/25_NORLAND_TRIP/WYS.pdf" target="_blank" rel="noopener noreferrer" class="instruction-link"><div class="instruction-icon-container"><span class="material-symbols-outlined text-xl">apartment</span></div><div class="instruction-content"><h4 class="font-semibold text-gray-800 text-sm">"Where You Stay" Form</h4><p class="text-xs text-gray-600 mt-1">Must be signed by a guardian.</p></div><span class="material-symbols-outlined text-base text-gray-400">open_in_new</span></a>
                                    <div class="instruction-card"><div class="instruction-icon-container"><span class="material-symbols-outlined text-xl">mail</span></div><div class="instruction-content"><h4 class="font-semibold text-gray-800 text-sm">Official Invitation Letter</h4><p class="text-xs text-gray-600 mt-1">The letter from Step 1.</p></div></div>
                                </div>
                            </div>
                        </div>
                    </div>`,
                3: `
                    <div class="m3-elevated-card p-6">
                        <h2 class="text-2xl font-bold text-gray-800 mb-3">Complete the Online Application</h2>
                        <p class="text-gray-600 mb-8">A parent or guardian must <span class="action-tag">fill out the form online</span>. Follow these required actions:</p>
                        <div class="space-y-4">
                            <a href="https://cova.mfa.gov.cn/qzCoCommonController.do?show&pageId=index&locale=en_US" target="_blank" rel="noopener noreferrer" class="instruction-link">
                                <div class="instruction-icon-container"><span class="material-symbols-outlined text-xl">language</span></div>
                                <div class="instruction-content">
                                    <h4 class="font-semibold text-gray-800 text-sm">Go to the Official Visa Website</h4>
                                    <p class="text-xs text-gray-600 mt-1">Select location: North America -> Washington, D.C.</p>
                                </div>
                                <span class="material-symbols-outlined text-base text-gray-400">open_in_new</span>
                            </a>
                            <div class="instruction-card"><div class="instruction-icon-container"><span class="material-symbols-outlined text-xl">edit_document</span></div><div class="instruction-content"><h4 class="font-semibold text-gray-800 text-sm">Fill Out the Form</h4><p class="text-xs text-gray-600 mt-1">Complete all sections accurately.</p></div></div>
                            <div class="instruction-card"><div class="instruction-icon-container"><span class="material-symbols-outlined text-xl">print</span></div><div class="instruction-content"><h4 class="font-semibold text-gray-800 text-sm">Save & Print</h4><p class="text-xs text-gray-600 mt-1">Save your application number and print all pages.</p></div></div>
                            <div class="instruction-card"><div class="instruction-icon-container"><span class="material-symbols-outlined text-xl">draw</span></div><div class="instruction-content"><h4 class="font-semibold text-gray-800 text-sm">Sign the Printed Form</h4><p class="text-xs text-gray-600 mt-1">A guardian must sign the confirmation & Section 9.1.</p></div></div>
                        </div>
                        <p class="text-sm text-red-600 mt-6"><strong>Important</strong>: The minor should not sign any part of the application.</p>
                    </div>`,
                4: `
                    <div class="m3-elevated-card p-6">
                        <h2 class="text-2xl font-bold text-gray-800 mb-3">Final Review & Submission</h2>
                        <p class="text-gray-600 mb-8">Your final action is to ensure your complete packet is ready for our team. Here is the handoff process:</p>
                        <div class="space-y-4">
                            <div class="instruction-card"><div class="instruction-icon-container"><span class="material-symbols-outlined text-xl">checklist</span></div><div class="instruction-content"><h4 class="font-semibold text-gray-800 text-sm">Our Final Review</h4><p class="text-xs text-gray-600 mt-1">We will review your folder for accuracy.</p></div></div>
                            <div class="instruction-card"><div class="instruction-icon-container"><span class="material-symbols-outlined text-xl">send</span></div><div class="instruction-content"><h4 class="font-semibold text-gray-800 text-sm">Submission</h4><p class="text-xs text-gray-600 mt-1">We submit the application on your behalf.</p></div></div>
                            <div class="instruction-card"><div class="instruction-icon-container"><span class="material-symbols-outlined text-xl">notifications</span></div><div class="instruction-content"><h4 class="font-semibold text-gray-800 text-sm">Notification</h4><p class="text-xs text-gray-600 mt-1">You will be notified when the visa is ready (3-4 days).</p></div></div>
                        </div>
                    </div>`
            };

            loadFlightData();
            setupTabs();
            setupStepper(stepContents);
            setupDashboard();
        });

        /** Loads flight data and updates UI cards. */
        async function loadFlightData() {
            try {
                const response = await fetch(`flights_data.json?v=${Date.now()}`);
                if (!response.ok) throw new Error(`HTTP Error: ${response.status}`);
                const data = await response.json();
                
                updateFlightCard('flight-card-fll', data['FLL-PVG']);
                updateFlightCard('flight-card-mia', data['MIA-PVG']);
            } catch (error) {
                console.error("Failed to load flight data:", error);
                ['flight-card-fll', 'flight-card-mia'].forEach(id => updateFlightCard(id, { status: 'data_load_failed' }));
            }
        }

        /** Populates a single flight card with data. */
        function updateFlightCard(cardId, data) {
            const card = document.getElementById(cardId);
            if (!card) return;
            const el = (selector) => card.querySelector(selector);
            const isSuccess = data?.status === 'ok' && data.price;

            card.classList.toggle('placeholder', !isSuccess);

            const priceEl = el('.flight-price-value');
            if (priceEl) {
                priceEl.innerHTML = isSuccess 
                    ? `<span class="currency">$</span>${data.price}` 
                    : `<span class="currency">$</span>----`;
            }

            const routeInfoEl = el('.flight-route-info');
            if (routeInfoEl) {
                routeInfoEl.textContent = isSuccess 
                    ? data.route_info || 'Route unavailable' 
                    : (data?.status || 'error').replace(/_/g, ' ');
            }

            const lastUpdatedEl = el('.flight-last-updated');
            if (lastUpdatedEl) {
                lastUpdatedEl.textContent = isSuccess && data.last_updated
                    ? `Updated: ${new Date(data.last_updated).toLocaleDateString('en-US', { day: 'numeric', month: 'short' })}`
                    : 'Update Failed';
            }

            const departureCode = cardId === 'flight-card-fll' ? 'FLL' : 'MIA';
            el('.flight-airport-code.departure').textContent = departureCode;
            el('.flight-airport-code.arrival').textContent = 'PVG';
        }

        /** Sets up tabbed navigation. */
        function setupTabs() {
            document.querySelector('.tabs-container')?.addEventListener('click', e => {
                const button = e.target.closest('.tab-btn[data-tab]');
                if (!button) return;
                document.querySelectorAll('.tab-btn').forEach(btn => {
                    btn.classList.remove('is-active');
                    btn.setAttribute('aria-selected', 'false');
                });
                document.querySelectorAll('.tab-content').forEach(content => content.style.display = 'none');
                
                button.classList.add('is-active');
                button.setAttribute('aria-selected', 'true');
                document.getElementById(button.dataset.tab).style.display = 'block';
            });
        }

        /** Initializes an interactive stepper component. */
        function setupStepper(contents) {
            const root = document.querySelector('.stepper');
            if (!root) return;
            const items = root.querySelectorAll('.stepper-item');
            const contentContainer = document.querySelector('.step-content-container');
            const nextBtn = document.getElementById('next-step-btn');
            const prevBtn = document.getElementById('prev-step-btn');
            let step = 1;

            const update = () => {
                items.forEach((item, i) => {
                    const stepNumber = i + 1;
                    item.classList.toggle('is-completed', stepNumber < step);
                    item.classList.toggle('is-active', stepNumber === step);
                });
                contentContainer.innerHTML = `<div class="step-content is-active" data-step-content="${step}">${contents[step]}</div>`;
                prevBtn.disabled = step === 1;
                nextBtn.textContent = step === items.length ? 'Finish' : 'Next Step';
            };

            const nav = (newStep) => { 
                step = Math.max(1, Math.min(newStep, items.length)); 
                update(); 
            };
            
            nextBtn.addEventListener('click', () => nav(step < items.length ? step + 1 : 1));
            prevBtn.addEventListener('click', () => nav(step - 1));
            root.addEventListener('click', e => {
                const item = e.target.closest('.stepper-item[data-step]');
                if (item) nav(+item.dataset.step);
            });
            update();
        }

        /** Configures the dashboard countdown card. */
        function setupDashboard() {
            const card = document.getElementById('date-card');
            if (!card) return;

            const dateView = document.getElementById('date-view');
            const countdownView = document.getElementById('countdown-view');
            const daysEl = document.getElementById('countdown-days');
            
            // Define the trip start and end dates
            const startDate = new Date('2025-08-01T00:00:00'); 
            const tripDate = new Date('2025-11-22T00:00:00');
            
            // Function to update the days left
            const updateCountdown = () => {
                const now = new Date();
                const timeLeftMs = tripDate.getTime() - now.getTime();
                
                const daysLeft = Math.max(0, Math.ceil(timeLeftMs / (1000 * 60 * 60 * 24)));
                
                daysEl.textContent = daysLeft;
            };

            // Set up initial state and update interval
            updateCountdown();
            setInterval(updateCountdown, 1000 * 60 * 60); // Update every hour

            // Add click listener to toggle views
            card.addEventListener('click', () => {
                dateView.classList.toggle('hidden');
                countdownView.classList.toggle('hidden');
            });
        }
    </script>
</body>
</html>
